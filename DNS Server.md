# bind9
---

#### Source
1. [linuxbabe.com](https://www.linuxbabe.com/debian/authoritative-dns-server-debian-10-buster-bind9)
2. [slashroot.in](https://www.slashroot.in/what-dns-zone-file-complete-tutorial-zone-file-and-its-contents)

#### Interactive terminal when SSH
```bash
$ export TERM=ansi
```

#### Configuration FQDN
```bash
$ su -
# hostnamectl tkj.com
# nano/vim /etc/hosts
...
192.168.56.103	tkj.com
...
```
- Restart VM

#### Configuration `bind9` as AUTHORITATIVE DNS-SERVER

1. Install bind9 package
```bash
$ su -
# apt install bind9 bind9utils -y
```

2. Check version
```bash
# named -v
# named -V
```

3. Make sure `bind9` is running & automatically running ( `enabled` ) on booting
```bash
# systemctl status bind9.service
Loaded: loaded (/lib/systemd/system/bind9.service; enabled; vendor preset: enabled)
   Active: active (running)
```

- If not, make it run & automatically running on booting
```bash
# systemctl start bind9.service
# systemctl enable bind9.service
```

- `bind9` is running on port 53
```bash
# ss -tulpn | grep 53
```

4. Disable recursion on bind9 as authoritative dns-server
```bash
# cd /etc/bind
# nano/vim named.conf.options
...
recursion no;
...
```

5. Prepare a domain name as FQDN: `tkj.com`
6. Edit `named.conf.local`
```bash
# cd /etc/bind
# nano/vim named.conf.local
...
zone "tkj.com" {
	type master;
	file "/etc/bind/db.tkj.com";
	allow-query { any; };
};
...
```

7. Create a file db.tkj.com on /etc/bind/ ( just copy db.empty )
```bash
# cd /etc/bind
# cp db.empty db.tkj.com
# nano/vim db.tkj.com
; BIND reverse data file for empty rfc1918 zone
;
; DO NOT EDIT THIS FILE - it is used for multiple zones.
; Instead, copy it, edit named.conf, and use that copy.
;
$TTL	86400
$ORIGIN tkj.com.
@	IN	SOA	ns1.tkj.com. admin.tkj.com. (
		    2022011903		; Serial
			604800		; Refresh
			 86400		; Retry
			2419200		; Expire
			 86400 )	; Negative Cache TTL
;
	IN	NS	ns1.tkj.com.
	IN	MX  10	mail.tkj.com.
www	IN	A	192.168.56.103
@	IN	A	192.168.56.103
ns1	IN	A	192.168.56.103
mail	IN	A	192.168.56.103
```

8. Restart `bind9`
```bash
# systemctl restart bind9.service
```

9. SetUp client's DNS-Server to `192.168.56.103`. Do `dig` or `drill` or `nslookup` on `tkj.com` with dns-record `A`, `NS`, `SOA`, `MX`
- If windows as client, just change DNS address to `192.168.56.103` in each network adapter.
- If linux as client, change `/etc/resolv.conf`
```bash
$ su -
# nano/vim /etc/resolv.com
nameserver 192.168.56.103
```

```bash
$ drill/dig tkj.com A
$ drill/dig tkj.com NS
$ drill/dig tkj.com SOA
$ drill/dig tkj.com MX
```

#dns #bind9 #debian